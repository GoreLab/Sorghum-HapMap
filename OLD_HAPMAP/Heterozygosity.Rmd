---
title: "R Notebook"
output: html_notebook
---

#Heterozygosity of the old dataset

## Heterozygosity of the full dataset:

```{r}

library(dplyr)
library(magrittr)
library(tidyr)

het <- read.delim(file = "/run/user/1000/gvfs/sftp:host=cbsugore02.tc.cornell.edu/workdir/rjl278/Sorghum/Imputation/het.table", header = T) %>% 
  rename(HOM1=OBS.HOM1, HOM2=HOM2. , ID=CHR_POS) %>%
  mutate(P.Het =  HET/(HOM1+HET+HOM2))

hist(het$P.Het, xlab= "% Heterozygosity", main="")

```

```{r}
library(scales)

maf_table <- het %>%
  sample_frac(.1) %>%
  mutate(MAF = case_when( HOM1 > HOM2 ~ (HET+HOM2*2)/(2*(HET+HOM1+HOM2)), 
                          HOM1 < HOM2 ~ (HET+HOM1*2)/(2*(HET+HOM1+HOM2)))) 


plot(maf_table$MAF, maf_table$P.Het, pch=1, cex=0.4, col=alpha("black",alpha = 0.1), xlab = "MAF", ylab = "% heterozygosity" )


```



## Heterozygosity in deleterious positions

```{r}

deleterious <- read.delim(file = "/run/user/1000/gvfs/sftp:host=cbsugore02.tc.cornell.edu/workdir/rjl278/Sorghum/Imputation/Deleterious.list", header = F)

del_table <- het %>%
  filter(ID %in% deleterious[,1])

hist(del_table$P.Het, xlab= "% Heterozygosity", main = "")

```

# Heterozygosity by MAF 

```{r}
library(scales)

maf_table <- het %>%
  filter(ID %in% deleterious[,1]) %>%
  mutate(MAF = case_when( HOM1 > HOM2 ~ (HET+HOM2*2)/(2*(HET+HOM1+HOM2)), 
                          HOM1 < HOM2 ~ (HET+HOM1*2)/(2*(HET+HOM1+HOM2)))) 


plot(maf_table$MAF, maf_table$P.Het, pch=1, cex=0.4, col=alpha("black",alpha = 0.2), xlab = "MAF", ylab = "% heterozygosity" )


```

```{r}

table <- read.delim(file = "/home/roberto/plots/5M_imputed.het", header = T)

hist(table$F, breaks = 20)
plot(density(table$F), ylab = "number of taxa", xlab= "Inbreeding coefficient", main="" )
```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
